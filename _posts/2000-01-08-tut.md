---
title: "Tut"
bg: turquoise
color: white
fa-icon: film
---
With the new Android 5 update Google rolled out many new Views and UI Changes. <h3><strong>The Odd Name</strong></h3> Google Describes RecyclerView as: <blockquote>A flexible view for providing a limited window into a large data set.</blockquote> <!--more--> in its API Documentation. RecyclerView is basically an upgrade to the ListView. Let&#39;s assume a View with multiple similar child views like Contacts, Folders, Messages. As soon as a user scrolls a currently visible item out of view, this item’s view can be recycled and reused whenever a new item comes into view.Here is when recycling and reuse comes into play. Now that you have a brief idea about what is <em>RecyclerView</em>, Let&#39;s jump to <strong>TwoWayView</strong>. <strong>TwoWayView</strong> is <strong>Lucas Rocha&#39;s</strong> Project that simplifies the RecyclerView implementation. For most of the cases the default layouts provided in the TwoWayView should suffice, Custom LayoutManagers are also Supported. Which are simpler to write using TwoWayView framework than with the base RecyclerView. Using it helps you get rid of some of RecyclerView‘s complexity like specicfied above. <h3><strong>Getting Started</strong></h3> In this tutorial we are going to create a Custom RecyclerView with the Help of TwoWayView Library, with Search Functionality. <a href="https://play.google.com/store/apps/details?id=com.quasar_academy.twowayview"> <img alt="Get it on Google Play" src="https://developer.android.com/images/brand/en_generic_rgb_wo_60.png" /> </a> <a href="http://quasar-academy.com/wp-content/uploads/2014/11/DFG_2014-11-23-12-34-46.png"><img src="http://quasar-academy.com/wp-content/uploads/2014/11/DFG_2014-11-23-12-34-46-605x1024.png" alt="DFG_2014-11-23-12-34-46" width="605" height="1024" class="alignnone size-large wp-image-663" data-wp-pid="663" /></a> <ol class="simple-list"> <li><h4><strong>Creating a New Project</strong></h4> <ul class="list-group"> <li class="list-group-item">Application Name: twowayview</li> <li class="list-group-item">Comapany Domain: quasar-academy.com</li> <li class="list-group-item">Set Min SDK to 14</li> <li class="list-group-item">Create a Blank Activity with Fragment.</li> <li class="list-group-item">Finish with the New Project Wizard</li> </ul> </li> <li> <h4><strong>Adding Dependecies to you&#39;re project</strong></h4> <pre class="prettyprint linenums"><code class="language-java">repositories { maven { url "https://oss.sonatype.org/content/repositories/snapshots/" } } dependencies { compile &#39;org.lucasr.twowayview:core:1.0.0-SNAPSHOT@aar&#39; // For Core TwowayView Functionality compile &#39;org.lucasr.twowayview:layouts:1.0.0-SNAPSHOT@aar&#39; // For Additional Layouts compile &#39;com.android.support:recyclerview-v7:21.0.0&#39; // RecyclerView provided by Android compile &#39;com.squareup.picasso:picasso:2.4.0&#39; // To make image Loading Easier compile &#39;me.neavo:volley:2014.10.9&#39; // Easy Networking compile &#39;com.android.support:appcompat-v7:21.0.0&#39; //Appcompact Lib for Campatibility } </code></pre> </li> <div class="alert alert-warning"><strong>Note:</strong>TwoWayView is under development right now. Therefore we need to add snapshots of the library.</div> <li> <h4><strong>Creating a Singleton Class for proper Volley Functioning</strong></h4> Under <strong>app</strong> package create class named <strong>AppController.java</strong>. This is a singleton class which initializes global instances of required classes. All the objects related to volley are initialized here. <pre class="prettyprint linenums"><code class="language-java">public class AppController extends Application { public static final String TAG = AppController.class.getSimpleName(); private RequestQueue mRequestQueue; private static AppController mInstance; @Override public void onCreate() { super.onCreate(); mInstance = this; } public static synchronized AppController getInstance() { return mInstance; } public RequestQueue getRequestQueue() { if (mRequestQueue == null) { mRequestQueue = Volley.newRequestQueue(getApplicationContext()); } return mRequestQueue; } public <T> void addToRequestQueue(Request<T> req, String tag) { req.setTag(TextUtils.isEmpty(tag) ? TAG : tag); getRequestQueue().add(req); } public <T> void addToRequestQueue(Request<T> req) { req.setTag(TAG); getRequestQueue().add(req); } public void cancelPendingRequests(Object tag) { if (mRequestQueue != null) { mRequestQueue.cancelAll(tag); } } } </code></pre> </li> <li><h4><strong>Registering AppController.java in Android Manifest</strong></h4> Now, In the <strong>androidmanifest.xml</strong> add <strong>AppController</strong> as <strong>name</strong> in the <strong>Application</strong> tag. <pre class="prettyprint linenums"><code class="language-xml"><application android:name=".AppController"> ....</application> </code></pre> We&#39;ll also require permission to access Internet and Check Network State.Add them in the Manifest as well outside the application tag. <pre class="prettyprint linenums"><code class="language-xml"><uses-permission android:name="android.permission.INTERNET"/> <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/> </code></pre> You&#39;re <strong>AndroidManifest.xml</strong> should look like this. <pre class="prettyprint linenums"><code class="language-xml"><?xml version="1.0" encoding="utf-8"?> <manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.quasar_academy.twowayview" > <uses-permission android:name="android.permission.INTERNET"/> <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/> <application android:allowBackup="true" android:icon="@drawable/ic_launcher" android:label="@string/app_name" android:name=".AppController" android:theme="@style/AppTheme" > <activity android:name=".MyActivity" android:label="@string/app_name" > <intent-filter> <action android:name="android.intent.action.MAIN" /> <category android:name="android.intent.category.LAUNCHER" /> </intent-filter> </activity> </application> </manifest> </code></pre> </li> <li> <h4><strong>Adding TwoWayView to the Fragment</strong></h4> Adding EditText and TwoWayView to the Fragment Layout <strong>fragment_my.xml</strong>. <pre class="prettyprint linenums"><code class="language-xml"><LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:layout_height="match_parent" android:orientation="vertical" android:paddingBottom="@dimen/activity_vertical_margin"> <EditText android:id="@+id/edit_recycler" android:layout_width="match_parent" android:layout_height="wrap_content" /> <org.lucasr.twowayview.widget.TwoWayView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:id="@+id/list" android:layout_width="match_parent" android:layout_height="wrap_content" style="@style/TwoWayView" app:twowayview_layoutManager="SpannableGridLayoutManager" app:twowayview_numColumns="3" app:twowayview_numRows="2" /> </LinearLayout> </code></pre> </li> <li> <h4><strong>Creating The Layout of a single item</strong></h4> Create <strong>item.xml</strong> in layout folder.This layout file represents each individual feed item row in the list view. <pre class="prettyprint linenums"><code class="language-xml"><?xml version="1.0" encoding="utf-8"?> <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" android:layout_width="match_parent" android:orientation="vertical" android:layout_height="match_parent"> <FrameLayout android:layout_width="match_parent" android:layout_height="match_parent"> <ImageView android:id="@+id/featured_src" android:layout_width="match_parent" android:layout_height="match_parent" android:scaleType="centerCrop"/> <TextView android:id="@+id/title" android:layout_width="match_parent" android:textStyle="bold" android:textSize="18sp" android:layout_gravity="bottom" android:layout_height="wrap_content" style="@style/StateText"></TextView> </FrameLayout> </LinearLayout> </code></pre> </li> <li> <h4><strong>Creating the POJO Class</strong></h4> Create a class named Product.java. This is a POJO class used to create objects for each feed item while parsing the JSON Data. The Product object contains information like id, title, description, image url. <pre class="prettyprint linenums"><code class="language-java">public class Product implements Serializable { String featured_src; String title; String description; int id; public Product() { } public Product(String featured_src, String title, String description, int id) { this.featured_src = featured_src; this.title = title; this.description = description; this.id = id; } public String getFeatured_src() { return featured_src; } public void setFeatured_src(String featured_src) { this.featured_src = featured_src; } public String getTitle() { return title; } public void setTitle(String title) { this.title = title; } public String getDescription() { return description; } public void setDescription(String description) { this.description = description; } public int getId() { return id; } public void setId(int id) { this.id = id; } } </code></pre> </li> <li> <h4><strong>Setting Up ViewHolder</strong></h4> ViewHolders are basically caches of your View objects. You can Create your custom ViewHolder by extending RecyclerView.ViewHolder. <pre class="prettyprint linenums"><code class="language-java">public static class SimpleViewHolder extends RecyclerView.ViewHolder { public final TextView title; public final ImageView featured_src; public Product product; public SimpleViewHolder(View view) { super(view); title = (TextView) view.findViewById(R.id.title); featured_src = (ImageView) view.findViewById(R.id.featured_src); } public void setData(Context mContext,Product product){ this.product=product; if(title!=null) title.setText(product.getTitle().toString()); if(featured_src!=null) Picasso.with(mContext).load(product.getFeatured_src()).into(featured_src); } } </code></pre> </li> <li><h4><strong>Here Comes the Adapter</strong></h4> Adapters has two roles: They provide access to the underlying data set and they are responsible for creating the correct layout for individual items.RecyclerView has replaced the old Adapter interface with a new RecyclerView.Adapter base class. RecyclerView.Adapter is an abstract so we will have to implement these three methods: <ul class="list-group"> <li class="list-group-item">public ViewH onCreateViewHolder(ViewGroup parent, int viewType)</li> <li class="list-group-item">public void onBindViewHolder(ViewH holder, int position)</li> <li class="list-group-item">public int getItemCount()</li> </ul> On Overiding these methods and Creating a method filter() to make RecyclerView Filterable we get the following class. <pre class="prettyprint linenums"><code class="language-java">public class LayoutAdapter extends RecyclerView.Adapter<LayoutAdapter.SimpleViewHolder> { private final Context mContext; private final TwoWayView mRecyclerView; private ArrayList<Product> arraylist; private final int mLayoutId; private List<Product> productlist = null; public static class SimpleViewHolder extends RecyclerView.ViewHolder { public final TextView title; public final ImageView featured_src; public Product product; public SimpleViewHolder(View view) { super(view); title = (TextView) view.findViewById(R.id.title); featured_src = (ImageView) view.findViewById(R.id.featured_src); } public void setData(Context mContext,Product product){ this.product=product; if(title!=null) title.setText(product.getTitle().toString()); if(featured_src!=null) Picasso.with(mContext).load(product.getFeatured_src()).into(featured_src); } } public LayoutAdapter(Context context, TwoWayView recyclerView, int layoutId, List<Product> productlist) { mContext = context; this.productlist=productlist; mRecyclerView = recyclerView; mLayoutId = layoutId; this.arraylist = new ArrayList<Product>(); this.arraylist.addAll(productlist); } //Function To filter RecyclerView public void filter(String charText) { charText = charText.toLowerCase(Locale.getDefault()); productlist.clear(); if (charText.length() == 0) { productlist.addAll(arraylist); } else { for (Product wp : arraylist) { if (wp.getTitle().toLowerCase(Locale.getDefault()).contains(charText)||wp.getDescription().toLowerCase(Locale.getDefault()).contains(charText)) { productlist.add(wp); } } } notifyDataSetChanged(); } @Override public SimpleViewHolder onCreateViewHolder(ViewGroup parent, int viewType) { final View view = LayoutInflater.from(mContext).inflate(R.layout.item, parent, false); return new SimpleViewHolder(view); } @Override public void onBindViewHolder(SimpleViewHolder holder, int position) { holder.setData(mContext,productlist.get(position)); boolean isVertical = (mRecyclerView.getOrientation() == TwoWayLayoutManager.Orientation.VERTICAL); final View itemView = holder.itemView; final int itemId = position; if (mLayoutId == R.layout.fragment_my) { final SpannableGridLayoutManager.LayoutParams lp = (SpannableGridLayoutManager.LayoutParams) itemView.getLayoutParams(); final int span1 = (itemId == 0 || itemId == 3 ? 2 : 1); final int span2 = (itemId == 0 ? 2 : (itemId == 3 ? 3 : 1)); final int colSpan = (isVertical ? span2 : span1); final int rowSpan = (isVertical ? span1 : span2); if (lp.rowSpan != rowSpan || lp.colSpan != colSpan) { lp.rowSpan = rowSpan; lp.colSpan = colSpan; itemView.setLayoutParams(lp); } } } @Override public int getItemCount() { return productlist.size(); } } </code></pre> </li> <li><h4><strong>Finally Initializing RecyclerView in the Fragment</strong></h4> <ul class="list-group"> <li class="list-group-item"><strong>Initializing the RecyclerView.</strong> <pre class="prettyprint linenums"><code class="language-java">mRecyclerView = (TwoWayView) view.findViewById(R.id.list); mRecyclerView.setHasFixedSize(true); mRecyclerView.setHapticFeedbackEnabled(true); mRecyclerView.setLongClickable(true); mRecyclerView.setItemAnimator(new DefaultItemAnimator()); </code></pre> The Above code Initializes the RecyclerView. Setting Fixed Sized to be <strong>True</strong> increases the performance of RecyclerView. </li> <li class="list-group-item"> <strong>Setting up ClickListeners</strong> <a href="http://quasar-academy.com/wp-content/uploads/2014/11/DFG_2014-11-23-12-35-43.png"><img src="http://quasar-academy.com/wp-content/uploads/2014/11/DFG_2014-11-23-12-35-43-605x1024.png" alt="DFG_2014-11-23-12-35-43" width="605" height="1024" class="alignnone size-large wp-image-666" data-wp-pid="666" /></a> <pre class="prettyprint linenums"><code class="language-java">final ItemClickSupport itemClick = ItemClickSupport.addTo(mRecyclerView); itemClick.setOnItemClickListener(new ItemClickSupport.OnItemClickListener() { @Override public void onItemClick(RecyclerView parent, View child, int position, long id) { LayoutAdapter.SimpleViewHolder childViewHolder = (LayoutAdapter.SimpleViewHolder) parent.getChildViewHolder(child); mToast.setText("Clicked " + childViewHolder.product.getTitle()); mToast.show(); } }); itemClick.setOnItemLongClickListener(new ItemClickSupport.OnItemLongClickListener() { @Override public boolean onItemLongClick(RecyclerView parent, View child, int position, long id) { LayoutAdapter.SimpleViewHolder childViewHolder = (LayoutAdapter.SimpleViewHolder) parent.getChildViewHolder(child); mToast.setText("Long Clicked "+childViewHolder.product.getDescription()); mToast.show(); return true; } }); </code></pre> </li> <li class="list-group-item">Setting up ScrollListener <pre class="prettyprint linenums"><code class="language-java">mRecyclerView.setOnScrollListener(new RecyclerView.OnScrollListener() { @Override public void onScrollStateChanged(RecyclerView recyclerView, int scrollState) { } @Override public void onScrolled(RecyclerView recyclerView, int i, int i2) { if(!(mRecyclerView.getFirstVisiblePosition()==0||mRecyclerView.getFirstVisiblePosition()>0)) mRecyclerView.scrollToPosition(0); } }); </code></pre> </li> <li class="list-group-item"> <strong>Populating the View</strong> Now hat all the listeners are set and view has been initialized, we move to populating the view. Firstly, Let&#39;s Load the data from the internet. Using methods provided in the Volley Library. In the following method we are sending GET request to the server and Listening to Response which is in JSON format. <pre class="prettyprint linenums"><code class="language-java">public void loadData(){ JsonObjectRequest jsonReq = new JsonObjectRequest(Request.Method.GET, "http://quasar-academy.com/tutorial-server/recycler_json.php", null, new Response.Listener<JSONObject>() { @Override public void onResponse(JSONObject response) { VolleyLog.d("VOLLEY", "Response: " + response.toString()); if (response != null) { parseJsonFeed(response); } } }, new Response.ErrorListener() { @Override public void onErrorResponse(VolleyError error) { VolleyLog.d("VOLLEY", "Error: " + error.getMessage()); } }); if (isNetworkConnected()) AppController.getInstance().addToRequestQueue(jsonReq); else { editsearch.setEnabled(false); mToast.setText("Connect To the Internet"); mToast.setDuration(Toast.LENGTH_LONG); mToast.show(); } } </code></pre> </li><li class="list-group-item"> <strong>Parsing JSON Feed</strong> The JSON Received from the source is Like the one given below. <pre class="prettyprint linenums"><code class="language-json">{ "products": [{ "featured_src":"http://www.hdwallpapers.net/slider/img/car_wallpaper.jpg", "title":"Lamborghini", "description":"This is one of the Best Super Cars in the World.", "id":1 },{ "featured_src":"http://www.androidcentral.com/sites/androidcentral.com/files/styles/w550h500/public/wallpapers/black-3d-tiles-vo4.jpg", "title":"Black Tiles", "description":"Black Tiles Wallpaper", "id":2 },{ "featured_src":"http://3.bp.blogspot.com/-aJYmRwG0XDs/T4gASfTX-WI/AAAAAAAABrw/7qh_7j9USU0/s1600/Balck%2BWallpaper%2B%25284%2529.jpg", "title":"Black and White", "description":"Black White Wallpaper", "id":3 }, ... ... ... ... ] } </code></pre> </li> <li class="list-group-item"> <strong>To Retrieve Data from response we need to parse the JSON.</strong> <pre class="prettyprint linenums"><code class="language-java">private void parseJsonFeed(JSONObject response) { try { JSONArray feedArray = response.getJSONArray("products"); for (int i = 0; i < feedArray.length(); i++) { JSONObject feedObj = (JSONObject) feedArray.get(i); Product item = new Product(); item.setId(feedObj.getInt("id")); item.setTitle(feedObj.getString("title")); item.setDescription(feedObj.getString("description")); item.setFeatured_src(feedObj.getString(("featured_src"))); arraylist.add(item); Log.d("LOAD DATA", item.getId() + " " + item.getTitle() + " " + item.getDescription()); } adapter = new LayoutAdapter(getActivity(), mRecyclerView, mLayoutId,arraylist); mRecyclerView.setAdapter(adapter); } catch (JSONException e) { e.printStackTrace(); } } </code></pre> </li> <li class="list-group-item"> After Parsing the Complete Array of Products is added to the Adapter. <strong>The Complete Code of the Fragment. </strong> <pre class="prettyprint linenums"><code class="language-java">public class PlaceholderFragment extends Fragment { private TwoWayView mRecyclerView; LayoutAdapter adapter; private Toast mToast; ArrayList<Product> arraylist = new ArrayList<Product>(); private int mLayoutId; EditText editsearch; @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); mLayoutId = R.layout.fragment_my; } @Override public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) { return inflater.inflate(mLayoutId, container, false); } @Override public void onViewCreated(View view, Bundle savedInstanceState) { super.onViewCreated(view, savedInstanceState); final Activity activity = getActivity(); mToast = Toast.makeText(activity, "", Toast.LENGTH_SHORT); mToast.setGravity(Gravity.CENTER, 0, 0); mRecyclerView = (TwoWayView) view.findViewById(R.id.list); mRecyclerView.setHasFixedSize(true); mRecyclerView.setHapticFeedbackEnabled(true); mRecyclerView.setLongClickable(true); mRecyclerView.setItemAnimator(new DefaultItemAnimator()); editsearch = (EditText) view.findViewById(R.id.edit_recycler); // Capture Text in EditText editsearch.addTextChangedListener(new TextWatcher() { @Override public void afterTextChanged(Editable arg0) { // TODO Auto-generated method stub String text = editsearch.getText().toString().toLowerCase(Locale.getDefault()); adapter.filter(text); } @Override public void beforeTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) { // TODO Auto-generated method stub } @Override public void onTextChanged(CharSequence arg0, int arg1, int arg2, int arg3) { // TODO Auto-generated method stub } }); final ItemClickSupport itemClick = ItemClickSupport.addTo(mRecyclerView); itemClick.setOnItemClickListener(new ItemClickSupport.OnItemClickListener() { @Override public void onItemClick(RecyclerView parent, View child, int position, long id) { LayoutAdapter.SimpleViewHolder childViewHolder = (LayoutAdapter.SimpleViewHolder) parent.getChildViewHolder(child); mToast.setText("Clicked " + childViewHolder.product.getTitle()); mToast.show(); } }); itemClick.setOnItemLongClickListener(new ItemClickSupport.OnItemLongClickListener() { @Override public boolean onItemLongClick(RecyclerView parent, View child, int position, long id) { LayoutAdapter.SimpleViewHolder childViewHolder = (LayoutAdapter.SimpleViewHolder) parent.getChildViewHolder(child); mToast.setText("Long Clicked "+childViewHolder.product.getDescription()); mToast.show(); return true; } }); mRecyclerView.setOnScrollListener(new RecyclerView.OnScrollListener() { @Override public void onScrollStateChanged(RecyclerView recyclerView, int scrollState) { } @Override public void onScrolled(RecyclerView recyclerView, int i, int i2) { if(!(mRecyclerView.getFirstVisiblePosition()==0||mRecyclerView.getFirstVisiblePosition()>0)) mRecyclerView.scrollToPosition(0); } }); final Drawable divider = getResources().getDrawable(R.drawable.divider); mRecyclerView.addItemDecoration(new DividerItemDecoration(divider)); loadData(); } public void loadData(){ JsonObjectRequest jsonReq = new JsonObjectRequest(Request.Method.GET, "http://quasar-academy.com/tutorial-server/recycler_json.php", null, new Response.Listener<JSONObject>() { @Override public void onResponse(JSONObject response) { VolleyLog.d("VOLLEY", "Response: " + response.toString()); if (response != null) { parseJsonFeed(response); } } }, new Response.ErrorListener() { @Override public void onErrorResponse(VolleyError error) { VolleyLog.d("VOLLEY", "Error: " + error.getMessage()); } }); if (isNetworkConnected()) AppController.getInstance().addToRequestQueue(jsonReq); else { editsearch.setEnabled(false); mToast.setText("Connect To the Internet"); mToast.setDuration(Toast.LENGTH_LONG); mToast.show(); } } public boolean isNetworkConnected() { ConnectivityManager cm = (ConnectivityManager) getActivity() .getSystemService(Context.CONNECTIVITY_SERVICE); NetworkInfo ni = cm.getActiveNetworkInfo(); if (ni == null) { // There are no active networks. return false; } else return true; } private void parseJsonFeed(JSONObject response) { try { JSONArray feedArray = response.getJSONArray("products"); for (int i = 0; i < feedArray.length(); i++) { JSONObject feedObj = (JSONObject) feedArray.get(i); Product item = new Product(); item.setId(feedObj.getInt("id")); item.setTitle(feedObj.getString("title")); item.setDescription(feedObj.getString("description")); item.setFeatured_src(feedObj.getString(("featured_src"))); arraylist.add(item); Log.d("LOAD DATA", item.getId() + " " + item.getTitle() + " " + item.getDescription()); } adapter = new LayoutAdapter(getActivity(), mRecyclerView, mLayoutId,arraylist); mRecyclerView.setAdapter(adapter); } catch (JSONException e) { e.printStackTrace(); } } } </code></pre> </li> </ul> </li> <li><h4><strong>Have Fun Programming your RecyclerView</strong></h4> The source code can be Downloaded from <a href="https://github.com/quasar-academy/RecyclerView" title="Github Repository" target="_blank">Github</a>. If you Like Our Tutorials Please Do <strong>Subscribe</strong>. </li> </ol>